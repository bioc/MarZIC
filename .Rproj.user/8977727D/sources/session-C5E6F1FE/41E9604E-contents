% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MarZICM.R
\name{MarZICM}
\alias{MarZICM}
\title{Marginal Mediation Model for Zero-Inflated Compositional Mediators}
\usage{
MarZICM(
  Experiment_dat,
  lib_name,
  y_name,
  x_name,
  conf_name = NULL,
  mediator_mix_range = 1,
  transfer_to_RA = FALSE,
  num_cores = detectCores() - 2,
  adjust_method = "fdr",
  fdr_rate = 0.2,
  taxDropThresh = 0.8,
  taxDropCount = 20,
  SDThresh = 0.05,
  SDx = 0.05,
  SDy = 0.05
)
}
\arguments{
\item{Experiment_dat}{A SummarizedExperiment object containing microbiome data as assay and
covariates, outcome and library size as colData. The microbiome data could be relative abundance or absolute
abundance. Missing value should be imputed in advance.}

\item{lib_name}{Name of library size variable within colData.}

\item{y_name}{Name of outcome variable within colData.}

\item{x_name}{Name of covariate of interest within colData.}

\item{conf_name}{Name of confounders within colData. Defaule is NULL, meaning no confounder.}

\item{mediator_mix_range}{Number of mixtures in mediator. Default is 1, meaning no mixture.}

\item{transfer_to_RA}{Logical variable indicating whether the microbiome data should be
transferred to relative abundance. Default is FALSE. If TRUE, microbiome data will be rescaled
by its row sum.}

\item{num_cores}{Number of CPU cores to be used in parallelization task.}

\item{adjust_method}{P value adjustment method. Same as p.adjust. Default is "fdr".}

\item{fdr_rate}{FDR cutoff for significance. Default is 0.2.}

\item{taxDropThresh}{The threshold of dropping taxon due to high zero percentage. Default is
0.9, meaning taxon will be dropped for analysis if zero percentage is higher than 90%.}

\item{taxDropCount}{The threshold of dropping taxon due to not enough non-zero observation counts.
Default is 20, meaning taxon will be dropped if non-zero observation is less than 20.}

\item{SDThresh}{The threshold of dropping taxon due to low coefficient of variation (CV)
to avoid constant taxon.
Default is 0.05, meaning any taxon has CV less than 0.05 will be dropped.}

\item{SDx}{The threshold of stopping analysis due to low CV of covariate of interest.
Default is 0.05, meaning when CV of covariate of interest is less than 0.05, the analysis
will be stopped.}

\item{SDy}{The threshold of stopping analysis due to low CV of outcome.
Default is 0.05, meaning when CV of outcome. is less than 0.05, the analysis
will be stopped.}
}
\value{
A `list` of `4` datasets containing the results for `NIE1`, `NIE2`, `NDE`, and `NIE`.
Each dataset has row representing each taxon, 6 columns for `Estimates`, `Standard Error`,
`Lower bound for 95% Confidence Interval`, `Upper bound for 95% Confidence Interval`,
`Adjusted p value`, `Significance indicator`.
}
\description{
Run MarZIC and MarZICM
}
\examples{
{
library(MarZICM)
## A make up example with 1 taxon and 100 subjects.
set.seed(1)
nSub<-100
## generate covariate of interest X
X <- rbinom(nSub,1,0.5)
## generate mean of mediator M
mu <- exp(X)/(1+exp(X))
phi <- 10
## generate mediator M
M<-rbeta(nSub,mu*phi,(1-mu)*phi)
## library size set to 10000
libsize <- 10000
## generate observed zero, both structure zero and zero due to LOD mechanism
non_zero_ind <- 1 - rbinom(nSub,1,exp(0.3*X)/(1+exp(0.3*X)))
obs_m<-M * ((M * libsize)>1) * non_zero_ind
## generate outcome Y
Y <- 1 + 100 * M + (M > 0) + X
## Construct SummerizedExperiment object
CovData <- cbind(Y=Y,X=X,libsize=libsize)
test_dat <- SummarizedExperiment(assays=list(MicrobData=t(M)),colData=CovData)
res<-MarZICM(Experiment_dat = test_dat,
lib_name = "libsize",
y_name = "Y",
x_name = "X",
num_cores = 1,
mediator_mix_range = 1)

## Pull out significant NIE1
NIE1 <- res$NIE1
subset(NIE1,significance == TRUE)
}

}
